var htmlToPptxgenjsParser=function(e){"use strict";const t=require("css"),s=require("parse-color");function a(e){if(this.indent=-1,this.fontFace=e.fontFace||"Arial",this.fontSize=e.fontSize||12,this.options=e,this.cssRules=[],e.paraSpaceAfter&&(this.paraSpaceAfter=e.paraSpaceAfter),e.paraSpaceBefore&&(this.paraSpaceBefore=e.paraSpaceBefore),e.css){const s=t.parse(e.css);this.cssRules=s.stylesheet.rules}}a.prototype.setColor=function(e){const t=this.parseColor(e);t&&(this.color=t)},a.prototype.setFontFace=function(e){e&&(this.fontFace=e)},a.prototype.parseColor=function(e){const t=s(e);return t.hex&&t.hex.substring(1)},a.prototype.parseSize=function(e,t){let s,a,r=e.trim().match(/([\d\.]+)(%|em|pt|rem)/);switch(e){case"7":s=3;break;case"h1":case"xx-large":case"6":s=2;break;case"h2":case"x-large":case"5":s=1.5;break;case"h3":case"large":case"4":s=1.17;break;case"h4":case"medium":case"3":s=1;break;case"h5":case"small":case"2":s=.83;break;case"h6":case"x-small":case"1":s=.67;break;case"xx-small":s=.5}if(s)a=Math.round(this.fontSize*s);else if(r){const e=parseFloat(r[1]);switch(r[2]){case"%":a=Math.round(t[t.length-1].fontSize*e);break;case"em":a=this.fontSize*e;break;case"pt":a=e;break;case"rem":a=Math.round(t[0].fontSize*e)}}return a},a.prototype.setFontSize=function(e,t){const s=this.parseSize(e,t);s&&(this.fontSize=s)},a.prototype.applyStyleRules=function(e){e.forEach(e=>{const t=e.value,a=t.split(/\s+/);switch(e.property){case"background":case"background-color":{const e=this.parseColor(t);e&&(this.fill=e)}break;case"border":{const e=this.parseSize(a[0]),t=this.parseColor(a[1])||this.parseColor(a[2]);e&&t&&(this.outline={size:e,color:t})}break;case"color":this.setColor(t);break;case"font-family":this.setFontFace(t.split(",")[0].trim());break;case"font-size":this.setFontSize(t);break;case"font-style":this.i="italic"==t;break;case"font-weight":this.b="bold"==t||"bolder"==t||parseInt(t,10)>=700;break;case"margin":{const e=this.parseSize(a[0]);e&&(this.margin=e)}break;case"text-align":this.align=t;break;case"text-shadow":{const e=this.parseSize(a[0]),t=this.parseSize(a[1]),r=this.parseSize(a[2]),i=s(a[3]),o=(270+180*Math.atan2(x,y)/Math.PI)%360,c=Math.sqrt(e*e+t*t);null!=r&&i&&null!=c&&(this.shadow={type:"outer",angle:o,blur:r,color:i.hex.substring(1),offset:c,opacity:i.rgba[3]},console.log(this.shadow))}}})},a.prototype.setClass=function(e,t){this.cssRules.forEach(s=>{if("rule"===s.type){const a=s.selectors.includes(e);let r=!1;t&&t.split(" ").forEach(e=>{r|=e&&s.selectors.includes("."+e)}),(a||r)&&this.applyStyleRules(s.declarations)}})},a.prototype.setStyle=function(e){const s=t.parse("e {"+e+"}").stylesheet.rules[0].declarations;this.applyStyleRules(s)},a.prototype.toPptxTextOptions=function(){let e={};switch(e.align=this.align,e.bold=!!this.b,e.breakLine=!!this.break,e.softBreakBefore=!!this.softBreak,e.color=this.color,this.fill&&(e.fill=this.fill),e.fontFace=this.fontFace,e.fontSize=this.fontSize||this.defaultFontSize,e.italic=!!this.i,this.shadow&&(e.shadow=this.shadow),e.strike=!!this.s,e.subscript=!!this.sub,e.superscript=!!this.sup,e.underline=!!this.u,this.paraSpaceAfter&&(e.paraSpaceAfter=this.paraSpaceAfter),this.paraSpaceBefore&&(e.paraSpaceBefore=this.paraSpaceBefore),this.bullet){case!0:e.bullet=this.bulletOptions,e.indentLevel=this.indent;break;case!1:e.bullet=!1}if(this.href){let t=/\d+/.test(this.href)?"slide":"url";e.hyperlink={tooltip:this.href_title},e.hyperlink[t]=this.href}return e};const r=require("htmlparser2");return e.htmlToPptxText=function(e,t){let s=[],i=[new a(t=t||{})];function o(){return i[i.length-1]}function c(e){s.push({text:e,options:o().toPptxTextOptions()}),i.forEach(e=>{e.bullet=null})}function n(){let e=o();e.break=!0,c(""),e.break=!1}const l=new r.Parser({onopentag:function(e,s){let a=Object.create(o());switch(e){case"a":a.href=s.href,a.href_title=s.title;break;case"b":case"i":case"s":case"sub":case"sup":case"u":a[e]=!0;break;case"del":case"strong":a.b=!0;break;case"strike":a.s=!0;break;case"em":a.i=!0;break;case"br":!function(){let e=o();e.softBreak=!0,c(""),e.softBreak=!1}();break;case"p":t.paraSpaceBefore??(a.paraSpaceBefore=t.paraSpaceBefore);break;case"ol":a.indent++,a.bulletOptions={type:"number"};break;case"ul":a.indent++,a.bulletOptions=!0;break;case"li":a.bullet=!0;break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":a.b=!0,a.setFontSize(e);break;case"pre":a.pre=!0,a.setFontFace(t.preFontFace||"Courier New");break;case"font":a.setColor(s.color),a.setFontFace(s.face),a.setFontSize(s.size)}s.align&&(a.align=s.align),a.setClass(e,s.class),s.style&&a.setStyle(s.style),i.push(a)},ontext:function(e){o().pre||(e=e.replace(/\s+/g," ")),e&&c(e)},onclosetag:function(e){let s=o();switch(e){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":case"pre":n();break;case"ol":case"ul":0==s.indent&&(s.bullet=!1,c(""));break;case"p":t.paraSpaceAfter??(s.paraSpaceAfter=t.paraSpaceAfter),n()}s.align&&(s.align="left",c("")),i.pop()}},{decodeEntities:!0});return l.write(e),l.end(),s},e}({});
